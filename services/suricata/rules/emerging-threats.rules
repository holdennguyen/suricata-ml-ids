# Emerging Threats Rules for Educational Demo
# Simplified rules based on common threat patterns

# Web attacks
alert http any any -> any any (msg:"ET WEB_SPECIFIC_APPS Possible SQL Injection"; flow:established,to_server; content:"'"; http_uri; content:"or"; distance:0; within:10; nocase; classtype:web-application-attack; sid:2000001; rev:1;)
alert http any any -> any any (msg:"ET WEB_SPECIFIC_APPS Cross Site Scripting"; flow:established,to_server; content:"javascript:"; http_uri; nocase; classtype:web-application-attack; sid:2000002; rev:1;)

# Malware indicators
alert tcp any any -> any any (msg:"ET MALWARE Suspicious User-Agent"; flow:established,to_server; content:"User-Agent|3a 20|"; content:"bot"; distance:0; within:20; nocase; classtype:trojan-activity; sid:2000003; rev:1;)
alert tcp any any -> any any (msg:"ET MALWARE Suspicious POST Request"; flow:established,to_server; content:"POST"; http_method; content:"cmd="; http_client_body; nocase; classtype:trojan-activity; sid:2000004; rev:1;)

# Network anomalies
alert tcp any any -> any any (msg:"ET SCAN Potential TCP SYN Flood"; flags:S,12; threshold: type both, track by_dst, count 100, seconds 10; classtype:attempted-dos; sid:2000005; rev:1;)
alert udp any any -> any any (msg:"ET SCAN UDP Port Scan"; threshold: type both, track by_src, count 50, seconds 60; classtype:attempted-recon; sid:2000006; rev:1;)

# Protocol anomalies
alert tcp any any -> any any (msg:"ET POLICY Suspicious HTTP Response Code"; flow:established,from_server; content:"HTTP/1."; content:"404"; distance:0; within:10; threshold: type both, track by_src, count 20, seconds 60; classtype:policy-violation; sid:2000007; rev:1;)
alert dns any any -> any any (msg:"ET POLICY Suspicious DNS Response"; dns.opcode:0; dns.rcode:3; threshold: type both, track by_src, count 10, seconds 60; classtype:policy-violation; sid:2000008; rev:1;)
